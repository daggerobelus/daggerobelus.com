<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lorraine Witchcraft Trials: Network Analysis Dashboard</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
:root {
    --accused-color: #d62728;
    --witness-color: #1f77b4;
    --family-color: #9467bd;
    --family-witness-color: #17becf;
    --unknown-color: #7f7f7f;
    --positive-coef: #d62728;
    --negative-coef: #2ca02c;
    --bg-color: #1a1a2e;
    --card-bg: #16213e;
    --text-color: #e8e8e8;
    --muted-text: #a0a0a0;
    --border-color: #0f3460;
    --accent-color: #e94560;
    --tooltip-color: #f5f5f5;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    line-height: 1.6;
    min-height: 100vh;
}
.dashboard { max-width: 1600px; margin: 0 auto; padding: 20px; }
header {
    text-align: center;
    padding: 30px 20px;
    background: linear-gradient(135deg, var(--card-bg) 0%, #1a1a2e 100%);
    border-radius: 12px;
    margin-bottom: 24px;
    border: 1px solid var(--border-color);
}
header h1 { font-size: 2.2rem; font-weight: 600; margin-bottom: 8px; color: #fff; }
header p { color: var(--muted-text); font-size: 1.1rem; }
.stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
.stat-card {
    background: var(--card-bg);
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    border: 1px solid var(--border-color);
}
.stat-value { font-size: 2rem; font-weight: 700; color: var(--accent-color); }
.stat-label { font-size: 0.85rem; color: var(--muted-text); text-transform: uppercase; letter-spacing: 0.5px; }
.chart-grid { display: grid; gap: 20px; margin-bottom: 20px; }
.chart-row-full { grid-template-columns: 1fr; }
.chart-row-half { grid-template-columns: 1fr 1fr; }
.chart-container {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 20px;
    border: 1px solid var(--border-color);
}
.chart-container h3 { font-size: 1.1rem; margin-bottom: 4px; color: #fff; }
.chart-subtitle { font-size: 0.85rem; color: var(--muted-text); margin-bottom: 16px; }
.chart-area { width: 100%; min-height: 280px; }
#network-chart { min-height: 380px; }
.axis text { fill: var(--muted-text); font-size: 11px; }
.axis path, .axis line { stroke: var(--border-color); }
.grid line { stroke: var(--border-color); stroke-opacity: 0.3; }
.tooltip {
    position: absolute;
    background: rgba(22, 33, 62, 0.95);
    border: 1px solid var(--tooltip-color);
    border-radius: 6px;
    padding: 12px;
    font-size: 0.85rem;
    pointer-events: none;
    z-index: 1000;
    max-width: 300px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}
.tooltip-title { font-weight: 600; margin-bottom: 6px; color: #fff; }
.tooltip-value { color: var(--tooltip-color); font-size: 1.1rem; font-weight: 600; }
.tooltip-text { color: var(--muted-text); font-size: 0.8rem; margin-top: 6px; }
.legend { display: flex; gap: 20px; justify-content: center; margin-top: 12px; flex-wrap: wrap; }
.legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.8rem; color: var(--muted-text); }
.legend-color { width: 12px; height: 12px; border-radius: 50%; }
.node { stroke: #fff; stroke-width: 1.5; }
.link { stroke-opacity: 0.4; }
@media (max-width: 1200px) { .chart-row-half { grid-template-columns: 1fr; } }
@media (max-width: 768px) { .stats-row { grid-template-columns: repeat(2, 1fr); } header h1 { font-size: 1.6rem; } }
.finding-box { padding: 16px; border-radius: 8px; border-left: 4px solid; }
.finding-box strong { display: block; margin-bottom: 8px; }
.finding-box p { color: #a0a0a0; font-size: 0.9rem; margin: 0; }
    </style>
</head>
<body>
    <div class="dashboard">
        <header>
            <h1>Visualizing the Lorraine Witchcraft Trials (1580s-1620s)</h1>
            <p>Power, Authority, and the Dynamics of Accusation | Analysis of 347 Trials</p>
        </header>

        <div class="chart-grid chart-row-full" style="margin-bottom: 8px;">
            <div class="chart-container" style="padding: 16px 20px; background: linear-gradient(135deg, rgba(233, 69, 96, 0.1) 0%, rgba(22, 33, 62, 0.8) 100%);">
                <h2 style="color: #e94560; margin: 0; font-size: 1.4rem; font-weight: 600;">Social Network Analysis</h2>
                <p class="chart-subtitle" style="margin: 4px 0 0 0;">Examining the structural patterns of accusation through network metrics</p>
            </div>
        </div>

        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-value">10,652</div>
                <div class="stat-label">Network Nodes</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">17,227</div>
                <div class="stat-label">Relationships</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">313</div>
                <div class="stat-label">Accused Individuals</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">0.917</div>
                <div class="stat-label">Model AUC</div>
            </div>
        </div>

        <div class="chart-grid chart-row-full">
            <div class="chart-container">
                <h3>Accusation Waves: Network Activity Over Time</h3>
                <p class="chart-subtitle">Annual testimony and accusation activity showing peak persecution 1596-1603</p>
                <div class="chart-area" id="timeline-chart"></div>
                <div class="legend">
                    <div class="legend-item"><div class="legend-color" style="background: #d62728;"></div><span>Testimony edges</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #1f77b4;"></div><span>Total activity</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #e94560;"></div><span>Peak years</span></div>
                </div>
            </div>
        </div>

        <div class="chart-grid chart-row-half">
            <div class="chart-container">
                <h3>Risk Factors: What Predicted Accusation?</h3>
                <p class="chart-subtitle">Odds ratios from logistic regression. Red = increased risk, Green = protective</p>
                <div class="chart-area" id="odds-chart"></div>
            </div>
            <div class="chart-container">
                <h3>Network Visualization</h3>
                <p class="chart-subtitle">Top 150 connected individuals. Drag to rearrange, scroll to zoom.</p>
                <div class="chart-area" id="network-chart"></div>
                <div class="legend">
                    <div class="legend-item"><div class="legend-color" style="background: #d62728;"></div><span>Accused</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #1f77b4;"></div><span>Witness</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #17becf;"></div><span>Family + Witness</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #9467bd;"></div><span>Family</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #7f7f7f;"></div><span>Unknown</span></div>
                </div>
            </div>
        </div>

        <div class="chart-grid chart-row-half">
            <div class="chart-container">
                <h3>Centrality vs Clustering</h3>
                <p class="chart-subtitle">High clustering = high accusation risk</p>
                <div class="chart-area" id="scatter-chart"></div>
            </div>
            <div class="chart-container">
                <h3>Network Evolution Over Time</h3>
                <p class="chart-subtitle">Network expanded dramatically 1590-1610</p>
                <div class="chart-area" id="growth-chart"></div>
            </div>
        </div>

        <div class="chart-grid chart-row-full">
            <div class="chart-container">
                <h3>Key Findings</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 16px;">
                    <div class="finding-box" style="background: rgba(233, 69, 96, 0.1); border-color: #d62728;">
                        <strong style="color: #d62728;">High Clustering = High Risk (OR 6.4x)</strong>
                        <p>People in tight-knit local networks were 6.4x more likely to be accused.</p>
                    </div>
                    <div class="finding-box" style="background: rgba(44, 160, 44, 0.1); border-color: #2ca02c;">
                        <strong style="color: #2ca02c;">Bridge Positions = Protection (OR 0.5x)</strong>
                        <p>People bridging distant communities were half as likely to be accused.</p>
                    </div>
                    <div class="finding-box" style="background: rgba(31, 119, 180, 0.1); border-color: #1f77b4;">
                        <strong style="color: #1f77b4;">Not Contagion (r = -0.17)</strong>
                        <p>Accusations did NOT spread like a disease through social ties.</p>
                    </div>
                    <div class="finding-box" style="background: rgba(148, 103, 189, 0.1); border-color: #9467bd;">
                        <strong style="color: #9467bd;">245 Super-Witnesses</strong>
                        <p>A small group testified in 3+ trials. Only 1.6% ever became accused.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="chart-grid chart-row-full" style="margin-bottom: 8px;">
            <div class="chart-container" style="padding: 16px 20px; background: linear-gradient(135deg, rgba(233, 69, 96, 0.1) 0%, rgba(22, 33, 62, 0.8) 100%);">
                <h2 style="color: #e94560; margin: 0; font-size: 1.4rem; font-weight: 600;">Survival Analysis</h2>
                <p class="chart-subtitle" style="margin: 4px 0 0 0;">Why 10.1% escaped execution: Statistical analysis of the 35 non-death cases</p>
            </div>
        </div>

        <div class="chart-grid chart-row-half">
            <div class="chart-container">
                <h3>Confession & Sabbat: The Fatal Words</h3>
                <p class="chart-subtitle">Mean term frequency by outcome - confession and sabbat strongly predict death</p>
                <div id="confess-sabbat-chart" class="chart-area"></div>
            </div>
            <div class="chart-container">
                <h3>Trial Outcome Distribution</h3>
                <p class="chart-subtitle">Of 248 trials analyzed, 91% resulted in execution</p>
                <div id="outcome-dist-chart" class="chart-area"></div>
            </div>
        </div>

        <div class="chart-grid chart-row-full">
            <div class="chart-container">
                <h3>Term Frequencies by Outcome</h3>
                <p class="chart-subtitle">Comparing mean term occurrences across death sentence, released, and banished cases</p>
                <div id="term-freq-chart" class="chart-area"></div>
            </div>
        </div>

        <div class="chart-grid chart-row-full">
            <div class="chart-container">
                <h3>Confession Distribution by Outcome</h3>
                <p class="chart-subtitle">Individual case distribution shows confession terms cluster near zero for survivors (p=0.004)</p>
                <div id="confess-distribution-chart" class="chart-area"></div>
            </div>
        </div>

        <div class="chart-grid chart-row-half">
            <div class="chart-container">
                <h3>Torture Term Mentions by Outcome</h3>
                <p class="chart-subtitle">Torture was documented similarly across outcomes—resistance to confession mattered (p=0.22)</p>
                <div id="torture-chart" class="chart-area"></div>
            </div>
            <div class="chart-container">
                <h3>Sabbat Distribution by Outcome</h3>
                <p class="chart-subtitle">Sabbat mentions essentially absent in survivor cases (p=0.0005)</p>
                <div id="sabbat-distribution-chart" class="chart-area"></div>
            </div>
        </div>

        <div class="chart-grid chart-row-full">
            <div class="chart-container">
                <h3>Survival Analysis: Key Findings</h3>
                <p class="chart-subtitle">Statistical insights from the 35 non-death cases</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 16px;">
                    <div class="finding-box" style="background: rgba(255, 152, 0, 0.1); border-color: #ff9800;">
                        <strong style="color: #ff9800;">89.9% Death Rate</strong>
                        <p>312 of 347 trials ended in execution. Only 18 accused survived (9 released, 9 banished).</p>
                    </div>
                    <div class="finding-box" style="background: rgba(0, 188, 212, 0.1); border-color: #00bcd4;">
                        <strong style="color: #00bcd4;">Confession = Death (p=0.004)</strong>
                        <p>Survivors resisted torture without confessing. "Confess" and "sabbat" terms significantly lower in non-death cases.</p>
                    </div>
                    <div class="finding-box" style="background: rgba(156, 39, 176, 0.1); border-color: #9c27b0;">
                        <strong style="color: #9c27b0;">Sabbat Absence (p=0.0005)</strong>
                        <p>Sabbat mentions were essentially zero in banished cases (mean=0.00) vs 1.58 in death cases.</p>
                    </div>
                    <div class="finding-box" style="background: rgba(76, 175, 80, 0.1); border-color: #4caf50;">
                        <strong style="color: #4caf50;">Reputation Didn't Matter (p=0.97)</strong>
                        <p>Similar reputation levels across outcomes. Survival depended on what happened AFTER arrest, not before.</p>
                    </div>
                    <div class="finding-box" style="background: rgba(33, 150, 243, 0.1); border-color: #2196f3;">
                        <strong style="color: #2196f3;">Torture Not Predictive (p=0.22)</strong>
                        <p>Torture was applied similarly across outcomes. The key was whether the accused confessed, not whether they were tortured.</p>
                    </div>
                    <div class="finding-box" style="background: rgba(233, 69, 96, 0.1); border-color: #e94560;">
                        <strong style="color: #e94560;">The Change de Nancy</strong>
                        <p>The appellate court repeatedly overruled local prosecutors, providing some check on persecution—though rarely exercised.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="chart-grid chart-row-full">
            <div class="chart-container">
                <h3>Glossary of Terms</h3>
                <p class="chart-subtitle">Key concepts from social network analysis used in this dashboard</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 16px; margin-top: 16px;">

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Degree</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">The number of connections a person has. High degree = many relationships with other people in the network.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Clustering Coefficient</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">How much your connections know each other. High clustering = tight-knit group where everyone knows everyone (small village dynamics).</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Betweenness Centrality</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">How often someone lies on the shortest path between others. High betweenness = "bridge" connecting otherwise separate communities.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Brokerage Score</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">How many "structural holes" you span - connections between people who don't know each other. Brokers have access to diverse information.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Odds Ratio (OR)</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">How much more (or less) likely an outcome is. OR=2.0 means twice as likely; OR=0.5 means half as likely; OR=1.0 means no effect.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">AUC (Area Under Curve)</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">Model accuracy measure from 0.5 (random guess) to 1.0 (perfect). Our 0.917 means the model correctly identifies accused individuals 91.7% of the time.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Closeness Centrality</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">Average distance from a person to everyone else. High closeness = can reach anyone in the network quickly; positioned near the "center."</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">PageRank</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">Google's algorithm adapted for social networks. Importance flows through connections - being linked to by important people makes you important.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Super-Witness</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">Someone who testified in 3+ different witch trials. Likely professional witnesses or local officials who repeatedly participated in prosecutions.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Network Density</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">Ratio of actual connections to possible connections. Density=1.0 means everyone knows everyone; our network is ~0.0003 (very sparse, typical for large social networks).</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Contagion Model</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">Treating accusations like an infectious disease - if your neighbor is accused, you might "catch" it. Our data shows accusations did NOT spread this way.</p>
                    </div>

                    <div style="padding: 14px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        <strong style="color: #e94560;">Edge / Node</strong>
                        <p style="color: #a0a0a0; font-size: 0.85rem; margin-top: 6px;">Network building blocks. Nodes = people (accused, witnesses, others). Edges = relationships between them (testimony, kinship, co-witness, etc.).</p>
                    </div>

                </div>
            </div>
        </div>


        <footer style="text-align: center; padding: 30px; color: #666; font-size: 0.85rem;">
            <p>Data: Robin Briggs, <em>The Witches of Lorraine</em> (Oxford, 2007)</p>
            <p>Analysis: Social Network Analysis Pipeline | December 2024</p>
        </footer>
    </div>

    <script src="/projects/witchcraft/dashboard/witchcraft_data.js"></script>
    <script>
// Data loaded from witchcraft_data.js

const colors = {
    accused: '#d62728', witness: '#1f77b4', family: '#9467bd', family_witness: '#17becf', unknown: '#7f7f7f',
    positive: '#d62728', negative: '#2ca02c', accent: '#e94560'
};

const tooltip = d3.select('body').append('div').attr('class', 'tooltip').style('opacity', 0);

function showTooltip(event, html) {
    tooltip.transition().duration(100).style('opacity', 1);
    tooltip.html(html).style('left', (event.pageX + 15) + 'px').style('top', (event.pageY - 30) + 'px');
}
function hideTooltip() { tooltip.transition().duration(300).style('opacity', 0); }

// Chart 1: Timeline
function createTimeline(data, container) {
    const margin = { top: 20, right: 30, bottom: 50, left: 60 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 260 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const x = d3.scaleLinear().domain(d3.extent(data, d => d.year)).range([0, width]);
    const y = d3.scaleLinear().domain([0, d3.max(data, d => d.total_edges) * 1.1]).range([height, 0]);

    const area = d3.area().x(d => x(d.year)).y0(height).y1(d => y(d.testimony)).curve(d3.curveMonotoneX);
    const line = d3.line().x(d => x(d.year)).y(d => y(d.total_edges)).curve(d3.curveMonotoneX);

    svg.append('g').attr('class', 'grid').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).tickSize(-height).tickFormat(''));
    svg.append('path').datum(data).attr('fill', colors.accused).attr('fill-opacity', 0.7).attr('d', area);
    svg.append('path').datum(data).attr('fill', 'none').attr('stroke', colors.witness).attr('stroke-width', 2).attr('d', line);

    const peaks = data.filter(d => d.total_edges > 250);
    svg.selectAll('.peak').data(peaks).join('circle')
        .attr('cx', d => x(d.year)).attr('cy', d => y(d.total_edges))
        .attr('r', 5).attr('fill', colors.accent).attr('stroke', '#fff').attr('stroke-width', 2);

    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).tickFormat(d3.format('d')));
    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y));
    svg.append('text').attr('transform', 'rotate(-90)').attr('y', -45).attr('x', -height/2).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Network Activity (edges)');

    const bisect = d3.bisector(d => d.year).left;
    svg.append('rect').attr('width', width).attr('height', height).attr('fill', 'transparent')
        .on('mousemove', function(event) {
            const x0 = x.invert(d3.pointer(event)[0]);
            const d = data[bisect(data, x0, 1) - 1];
            if (d) showTooltip(event, `<div class="tooltip-title">${d.year}</div><div class="tooltip-value">${d.total_edges} edges</div><div class="tooltip-text">Testimony: ${d.testimony}</div>`);
        })
        .on('mouseout', hideTooltip);
}

// Chart 2: Odds Ratios
function createOddsChart(data, container) {
    const margin = { top: 20, right: 50, bottom: 40, left: 180 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 280 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const filtered = data.filter(d => !d.feature.startsWith('gender') && Math.abs(d.coefficient) > 0.1);
    const x = d3.scaleLinear().domain([0, d3.max(filtered, d => d.odds_ratio) * 1.1]).range([0, width]);
    const y = d3.scaleBand().domain(filtered.map(d => d.display_name)).range([0, height]).padding(0.4);

    svg.append('line').attr('x1', x(1)).attr('x2', x(1)).attr('y1', 0).attr('y2', height).attr('stroke', '#fff').attr('stroke-dasharray', '4,4').attr('stroke-opacity', 0.5);
    svg.append('text').attr('x', x(1)).attr('y', -5).attr('text-anchor', 'middle').attr('fill', '#a0a0a0').attr('font-size', '10px').text('OR=1');

    svg.selectAll('.line').data(filtered).join('line')
        .attr('x1', x(1)).attr('x2', d => x(d.odds_ratio))
        .attr('y1', d => y(d.display_name) + y.bandwidth()/2).attr('y2', d => y(d.display_name) + y.bandwidth()/2)
        .attr('stroke', '#0f3460').attr('stroke-width', 2);

    svg.selectAll('.circle').data(filtered).join('circle')
        .attr('cx', d => x(d.odds_ratio)).attr('cy', d => y(d.display_name) + y.bandwidth()/2)
        .attr('r', 10).attr('fill', d => d.odds_ratio > 1 ? colors.positive : colors.negative).attr('stroke', '#fff').attr('stroke-width', 2)
        .on('mouseover', (event, d) => showTooltip(event, `<div class="tooltip-title">${d.display_name}</div><div class="tooltip-value">${d.odds_ratio}x ${d.risk_direction} risk</div><div class="tooltip-text">${d.interpretation}</div>`))
        .on('mouseout', hideTooltip);

    svg.selectAll('.label').data(filtered).join('text')
        .attr('x', d => x(d.odds_ratio) + (d.odds_ratio > 1 ? 15 : -15))
        .attr('y', d => y(d.display_name) + y.bandwidth()/2 + 4)
        .attr('text-anchor', d => d.odds_ratio > 1 ? 'start' : 'end')
        .attr('fill', '#e8e8e8').attr('font-size', '11px').attr('font-weight', '600')
        .text(d => `${d.odds_ratio}x`);

    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y));
    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).ticks(5));
}

// Chart 3: Network
function createNetwork(data, container) {
    const width = container.clientWidth;
    const height = 360;

    const svg = d3.select(container).append('svg').attr('width', width).attr('height', height);
    const g = svg.append('g');
    svg.call(d3.zoom().scaleExtent([0.3, 4]).on('zoom', (e) => g.attr('transform', e.transform)));

    const nodeMap = new Map(data.nodes.map(d => [d.id, d]));
    const validLinks = data.links.filter(l => nodeMap.has(l.source) && nodeMap.has(l.target));

    const simulation = d3.forceSimulation(data.nodes)
        .force('link', d3.forceLink(validLinks).id(d => d.id).distance(25))
        .force('charge', d3.forceManyBody().strength(-40))
        .force('center', d3.forceCenter(width/2, height/2))
        .force('collision', d3.forceCollide().radius(d => Math.sqrt(d.degree) + 2));

    const link = g.append('g').selectAll('line').data(validLinks).join('line')
        .attr('stroke', d => d.type === 'TESTIFIED_AGAINST' ? colors.accused : colors.witness)
        .attr('stroke-opacity', 0.6).attr('stroke-width', 1.5);

    const node = g.append('g').selectAll('circle').data(data.nodes).join('circle')
        .attr('r', d => Math.max(3, Math.sqrt(d.degree) * 1.2))
        .attr('fill', d => colors[d.type] || colors.unknown)
        .attr('stroke', '#fff').attr('stroke-width', 1.5)
        .call(d3.drag().on('start', dragstart).on('drag', dragging).on('end', dragend))
        .on('mouseover', (e, d) => { d3.select(e.target).attr('stroke-width', 3); showTooltip(e, `<div class="tooltip-title">${d.id}</div><div class="tooltip-value">${d.type.replace('_', ' + ')}</div><div class="tooltip-text">Degree: ${d.degree}<br>Clustering: ${d.clustering}${d.trials ? '<br>Trials: ' + d.trials.join(', ') : ''}</div>`); })
        .on('mouseout', (e) => { d3.select(e.target).attr('stroke-width', 1.5); hideTooltip(); });

    simulation.on('tick', () => {
        link.attr('x1', d => d.source.x).attr('y1', d => d.source.y).attr('x2', d => d.target.x).attr('y2', d => d.target.y);
        node.attr('cx', d => d.x).attr('cy', d => d.y);
    });

    function dragstart(e) { if (!e.active) simulation.alphaTarget(0.3).restart(); e.subject.fx = e.subject.x; e.subject.fy = e.subject.y; }
    function dragging(e) { e.subject.fx = e.x; e.subject.fy = e.y; }
    function dragend(e) { if (!e.active) simulation.alphaTarget(0); e.subject.fx = null; e.subject.fy = null; }
}

// Chart 4: Scatter
function createScatter(data, container) {
    const margin = { top: 20, right: 30, bottom: 50, left: 60 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 280 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const x = d3.scaleLog().domain([1, d3.max(data, d => d.degree)]).range([0, width]);
    const y = d3.scaleLinear().domain([0, 1]).range([height, 0]);

    svg.append('g').attr('class', 'grid').call(d3.axisLeft(y).tickSize(-width).tickFormat(''));

    svg.selectAll('.point').data(data).join('circle')
        .attr('cx', d => x(Math.max(1, d.degree))).attr('cy', d => y(d.clustering)).attr('r', 4)
        .attr('fill', d => colors[d.type] || colors.unknown)
        .attr('opacity', 0.7).attr('stroke', '#fff').attr('stroke-width', 1)
        .on('mouseover', (e, d) => { d3.select(e.target).attr('r', 8); showTooltip(e, `<div class="tooltip-title">${d.name}</div><div class="tooltip-value">${d.type.replace('_', ' + ')}</div><div class="tooltip-text">Degree: ${d.degree}<br>Clustering: ${d.clustering}${d.trials ? '<br>Trials: ' + d.trials.join(', ') : ''}</div>`); })
        .on('mouseout', (e) => { d3.select(e.target).attr('r', 4); hideTooltip(); });

    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).ticks(5, '~s'));
    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y));
    svg.append('text').attr('x', width/2).attr('y', height + 40).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Degree (log scale)');
    svg.append('text').attr('transform', 'rotate(-90)').attr('y', -45).attr('x', -height/2).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Clustering Coefficient');
}

// Chart 5: Growth
function createGrowth(data, container) {
    const margin = { top: 20, right: 80, bottom: 50, left: 60 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 280 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const x = d3.scaleLinear().domain(d3.extent(data, d => d.start_year)).range([0, width]);
    const y = d3.scaleLinear().domain([0, d3.max(data, d => d.n_nodes) * 1.1]).range([height, 0]);

    const lineNodes = d3.line().x(d => x(d.start_year)).y(d => y(d.n_nodes)).curve(d3.curveMonotoneX);
    const lineEdges = d3.line().x(d => x(d.start_year)).y(d => y(d.n_edges)).curve(d3.curveMonotoneX);

    svg.append('g').attr('class', 'grid').call(d3.axisLeft(y).tickSize(-width).tickFormat(''));
    svg.append('path').datum(data).attr('fill', 'none').attr('stroke', colors.witness).attr('stroke-width', 2.5).attr('d', lineNodes);
    svg.append('path').datum(data).attr('fill', 'none').attr('stroke', colors.accent).attr('stroke-width', 2.5).attr('d', lineEdges);

    svg.selectAll('.dot').data(data).join('circle')
        .attr('cx', d => x(d.start_year)).attr('cy', d => y(d.n_nodes)).attr('r', 4).attr('fill', colors.witness).attr('stroke', '#fff').attr('stroke-width', 2)
        .on('mouseover', (e, d) => showTooltip(e, `<div class="tooltip-title">${d.period}</div><div class="tooltip-value">${d.n_nodes} nodes</div><div class="tooltip-text">${d.n_edges} edges</div>`))
        .on('mouseout', hideTooltip);

    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).tickFormat(d3.format('d')));
    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y));

    const legend = svg.append('g').attr('transform', `translate(${width - 70}, 10)`);
    legend.append('line').attr('x1', 0).attr('x2', 20).attr('y1', 0).attr('y2', 0).attr('stroke', colors.witness).attr('stroke-width', 2);
    legend.append('text').attr('x', 25).attr('y', 4).attr('fill', '#a0a0a0').attr('font-size', '11px').text('Nodes');
    legend.append('line').attr('x1', 0).attr('x2', 20).attr('y1', 20).attr('y2', 20).attr('stroke', colors.accent).attr('stroke-width', 2);
    legend.append('text').attr('x', 25).attr('y', 24).attr('fill', '#a0a0a0').attr('font-size', '11px').text('Edges');
}

// Survival Analysis Charts
const survivalColors = {
    'Death Sentence': '#e94560',
    'Released': '#4caf50',
    'Banished': '#2196f3',
    'Unknown': '#9e9e9e'
};

// Chart 6: Confession & Sabbat Grouped Bar
function createConfessSabbatChart(data, container) {
    const margin = { top: 30, right: 30, bottom: 60, left: 50 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 300 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const terms = ['confess', 'sabbat'];
    const outcomes = data.map(d => d.outcome);

    const x0 = d3.scaleBand().domain(terms).range([0, width]).padding(0.3);
    const x1 = d3.scaleBand().domain(outcomes).range([0, x0.bandwidth()]).padding(0.1);
    const y = d3.scaleLinear().domain([0, d3.max(data, d => Math.max(d.confess, d.sabbat)) * 1.1]).range([height, 0]);

    const termGroups = svg.selectAll('.term-group').data(terms).join('g')
        .attr('class', 'term-group')
        .attr('transform', d => `translate(${x0(d)},0)`);

    termGroups.selectAll('rect').data(term => data.map(d => ({outcome: d.outcome, value: d[term], term}))).join('rect')
        .attr('x', d => x1(d.outcome))
        .attr('y', d => y(d.value))
        .attr('width', x1.bandwidth())
        .attr('height', d => height - y(d.value))
        .attr('fill', d => survivalColors[d.outcome])
        .attr('rx', 3)
        .on('mouseover', (e, d) => showTooltip(e, `<div class="tooltip-title">${d.outcome}</div><div class="tooltip-value">${d.term}: ${d.value.toFixed(2)}</div>`))
        .on('mouseout', hideTooltip);

    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x0));
    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y).ticks(5));
    svg.append('text').attr('x', width/2).attr('y', height + 45).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Term');

    // Legend
    const legend = svg.append('g').attr('transform', `translate(${width - 120}, -10)`);
    outcomes.forEach((outcome, i) => {
        legend.append('rect').attr('x', 0).attr('y', i * 18).attr('width', 12).attr('height', 12).attr('fill', survivalColors[outcome]).attr('rx', 2);
        legend.append('text').attr('x', 18).attr('y', i * 18 + 10).attr('fill', '#a0a0a0').attr('font-size', '10px').text(outcome);
    });
}

// Chart 7: Outcome Distribution Donut
function createOutcomeDistChart(data, container) {
    const width = container.clientWidth;
    const height = 300;
    const radius = Math.min(width, height) / 2 - 40;

    const svg = d3.select(container).append('svg')
        .attr('width', width).attr('height', height)
        .append('g').attr('transform', `translate(${width/2},${height/2})`);

    const pie = d3.pie().value(d => d.count).sort(null);
    const arc = d3.arc().innerRadius(radius * 0.5).outerRadius(radius);
    const labelArc = d3.arc().innerRadius(radius * 0.75).outerRadius(radius * 0.75);

    const arcs = svg.selectAll('.arc').data(pie(data)).join('g').attr('class', 'arc');

    arcs.append('path')
        .attr('d', arc)
        .attr('fill', d => survivalColors[d.data.outcome])
        .attr('stroke', '#16213e').attr('stroke-width', 2)
        .on('mouseover', (e, d) => showTooltip(e, `<div class="tooltip-title">${d.data.outcome}</div><div class="tooltip-value">${d.data.count} trials</div><div class="tooltip-text">${(d.data.count / d3.sum(data, dd => dd.count) * 100).toFixed(1)}%</div>`))
        .on('mouseout', hideTooltip);

    arcs.append('text')
        .attr('transform', d => `translate(${labelArc.centroid(d)})`)
        .attr('text-anchor', 'middle').attr('fill', '#fff').attr('font-size', '11px').attr('font-weight', 'bold')
        .text(d => d.data.count > 10 ? d.data.count : '');

    // Center text
    svg.append('text').attr('text-anchor', 'middle').attr('y', -5).attr('fill', '#fff').attr('font-size', '24px').attr('font-weight', 'bold').text(d3.sum(data, d => d.count));
    svg.append('text').attr('text-anchor', 'middle').attr('y', 18).attr('fill', '#a0a0a0').attr('font-size', '12px').text('Total Trials');
}

// Chart 8: Term Frequency Grouped Bar
function createTermFreqChart(data, container) {
    const margin = { top: 30, right: 120, bottom: 60, left: 50 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 350 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const terms = ['reputation', 'witness', 'quarrel', 'torture', 'confess', 'sabbat', 'threat'];
    const outcomes = data.map(d => d.outcome);

    const x0 = d3.scaleBand().domain(terms).range([0, width]).padding(0.2);
    const x1 = d3.scaleBand().domain(outcomes).range([0, x0.bandwidth()]).padding(0.05);
    const y = d3.scaleLinear().domain([0, d3.max(data, d => Math.max(...terms.map(t => d[t]))) * 1.1]).range([height, 0]);

    const termGroups = svg.selectAll('.term-group').data(terms).join('g')
        .attr('class', 'term-group')
        .attr('transform', d => `translate(${x0(d)},0)`);

    termGroups.selectAll('rect').data(term => data.map(d => ({outcome: d.outcome, value: d[term], term}))).join('rect')
        .attr('x', d => x1(d.outcome))
        .attr('y', d => y(d.value))
        .attr('width', x1.bandwidth())
        .attr('height', d => height - y(d.value))
        .attr('fill', d => survivalColors[d.outcome])
        .attr('rx', 2)
        .on('mouseover', (e, d) => showTooltip(e, `<div class="tooltip-title">${d.outcome}</div><div class="tooltip-value">${d.term}: ${d.value.toFixed(2)}</div>`))
        .on('mouseout', hideTooltip);

    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x0)).selectAll('text').attr('transform', 'rotate(-25)').style('text-anchor', 'end');
    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y).ticks(6));
    svg.append('text').attr('transform', 'rotate(-90)').attr('y', -40).attr('x', -height/2).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Mean Term Count');

    // Legend
    const legend = svg.append('g').attr('transform', `translate(${width + 10}, 20)`);
    outcomes.forEach((outcome, i) => {
        legend.append('rect').attr('x', 0).attr('y', i * 22).attr('width', 14).attr('height', 14).attr('fill', survivalColors[outcome]).attr('rx', 2);
        legend.append('text').attr('x', 20).attr('y', i * 22 + 12).attr('fill', '#a0a0a0').attr('font-size', '11px').text(outcome);
    });
}

// Chart 9: Jitter/Strip Plot for Confess Distribution
function createConfessDistribution(cases, container) {
    const margin = { top: 30, right: 30, bottom: 50, left: 120 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 320 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const outcomes = ['Death Sentence', 'Released', 'Banished'];
    const y = d3.scaleBand().domain(outcomes).range([0, height]).padding(0.4);
    const x = d3.scaleLinear().domain([0, d3.max(cases, d => d.confess) + 1]).range([0, width]);

    // Add jitter
    cases.forEach(d => { d.jitter = (Math.random() - 0.5) * y.bandwidth() * 0.7; });

    svg.append('g').attr('class', 'grid').call(d3.axisBottom(x).tickSize(height).tickFormat(''));

    svg.selectAll('.point').data(cases).join('circle')
        .attr('cx', d => x(d.confess))
        .attr('cy', d => y(d.outcome) + y.bandwidth()/2 + d.jitter)
        .attr('r', 5)
        .attr('fill', d => survivalColors[d.outcome])
        .attr('opacity', 0.7)
        .attr('stroke', '#fff').attr('stroke-width', 1)
        .on('mouseover', (e, d) => { d3.select(e.target).attr('r', 8); showTooltip(e, `<div class="tooltip-title">${d.id}</div><div class="tooltip-value">Confess: ${d.confess}</div><div class="tooltip-text">${d.outcome}</div>`); })
        .on('mouseout', (e) => { d3.select(e.target).attr('r', 5); hideTooltip(); });

    // Add mean lines
    outcomes.forEach(outcome => {
        const subset = cases.filter(d => d.outcome === outcome);
        const mean = d3.mean(subset, d => d.confess);
        svg.append('line')
            .attr('x1', x(mean)).attr('x2', x(mean))
            .attr('y1', y(outcome)).attr('y2', y(outcome) + y.bandwidth())
            .attr('stroke', '#fff').attr('stroke-width', 2).attr('stroke-dasharray', '4,4');
        svg.append('text')
            .attr('x', x(mean) + 5).attr('y', y(outcome) + 12)
            .attr('fill', '#fff').attr('font-size', '10px').text(`μ=${mean.toFixed(1)}`);
    });

    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y));
    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).ticks(10));
    svg.append('text').attr('x', width/2).attr('y', height + 40).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Confession Term Count');
}

// Chart 10: Torture Box/Strip Plot
function createTortureChart(cases, container) {
    const margin = { top: 30, right: 30, bottom: 50, left: 120 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 300 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const outcomes = ['Death Sentence', 'Released', 'Banished'];
    const y = d3.scaleBand().domain(outcomes).range([0, height]).padding(0.4);
    const x = d3.scaleLinear().domain([0, d3.max(cases, d => d.torture) + 1]).range([0, width]);

    cases.forEach(d => { d.jitterT = (Math.random() - 0.5) * y.bandwidth() * 0.7; });

    svg.append('g').attr('class', 'grid').call(d3.axisBottom(x).tickSize(height).tickFormat(''));

    svg.selectAll('.point').data(cases).join('circle')
        .attr('cx', d => x(d.torture))
        .attr('cy', d => y(d.outcome) + y.bandwidth()/2 + d.jitterT)
        .attr('r', 5)
        .attr('fill', d => survivalColors[d.outcome])
        .attr('opacity', 0.7)
        .attr('stroke', '#fff').attr('stroke-width', 1)
        .on('mouseover', (e, d) => { d3.select(e.target).attr('r', 8); showTooltip(e, `<div class="tooltip-title">${d.id}</div><div class="tooltip-value">Torture: ${d.torture}</div>`); })
        .on('mouseout', (e) => { d3.select(e.target).attr('r', 5); hideTooltip(); });

    outcomes.forEach(outcome => {
        const subset = cases.filter(d => d.outcome === outcome);
        const mean = d3.mean(subset, d => d.torture);
        svg.append('line')
            .attr('x1', x(mean)).attr('x2', x(mean))
            .attr('y1', y(outcome)).attr('y2', y(outcome) + y.bandwidth())
            .attr('stroke', '#fff').attr('stroke-width', 2).attr('stroke-dasharray', '4,4');
    });

    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y));
    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).ticks(8));
    svg.append('text').attr('x', width/2).attr('y', height + 40).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Torture Term Count');
}

// Chart 11: Sabbat Distribution
function createSabbatDistribution(cases, container) {
    const margin = { top: 30, right: 30, bottom: 50, left: 120 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = 300 - margin.top - margin.bottom;

    const svg = d3.select(container).append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

    const outcomes = ['Death Sentence', 'Released', 'Banished'];
    const y = d3.scaleBand().domain(outcomes).range([0, height]).padding(0.4);
    const x = d3.scaleLinear().domain([0, d3.max(cases, d => d.sabbat) + 1]).range([0, width]);

    cases.forEach(d => { d.jitterS = (Math.random() - 0.5) * y.bandwidth() * 0.7; });

    svg.append('g').attr('class', 'grid').call(d3.axisBottom(x).tickSize(height).tickFormat(''));

    svg.selectAll('.point').data(cases).join('circle')
        .attr('cx', d => x(d.sabbat))
        .attr('cy', d => y(d.outcome) + y.bandwidth()/2 + d.jitterS)
        .attr('r', 5)
        .attr('fill', d => survivalColors[d.outcome])
        .attr('opacity', 0.7)
        .attr('stroke', '#fff').attr('stroke-width', 1)
        .on('mouseover', (e, d) => { d3.select(e.target).attr('r', 8); showTooltip(e, `<div class="tooltip-title">${d.id}</div><div class="tooltip-value">Sabbat: ${d.sabbat}</div>`); })
        .on('mouseout', (e) => { d3.select(e.target).attr('r', 5); hideTooltip(); });

    outcomes.forEach(outcome => {
        const subset = cases.filter(d => d.outcome === outcome);
        const mean = d3.mean(subset, d => d.sabbat);
        svg.append('line')
            .attr('x1', x(mean)).attr('x2', x(mean))
            .attr('y1', y(outcome)).attr('y2', y(outcome) + y.bandwidth())
            .attr('stroke', '#fff').attr('stroke-width', 2).attr('stroke-dasharray', '4,4');
        svg.append('text')
            .attr('x', x(mean) + 5).attr('y', y(outcome) + 12)
            .attr('fill', '#fff').attr('font-size', '10px').text(`μ=${mean.toFixed(1)}`);
    });

    svg.append('g').attr('class', 'axis').call(d3.axisLeft(y));
    svg.append('g').attr('class', 'axis').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x).ticks(8));
    svg.append('text').attr('x', width/2).attr('y', height + 40).attr('fill', '#a0a0a0').attr('text-anchor', 'middle').attr('font-size', '12px').text('Sabbat Term Count');
}

// Initialize all charts
createTimeline(DATA.waves, document.getElementById('timeline-chart'));
createOddsChart(DATA.coefficients, document.getElementById('odds-chart'));
createNetwork(DATA.network, document.getElementById('network-chart'));
createScatter(DATA.scatter, document.getElementById('scatter-chart'));
createGrowth(DATA.temporal, document.getElementById('growth-chart'));

// Initialize survival analysis charts
if (DATA.survival) {
    createConfessSabbatChart(DATA.survival.termComparison, document.getElementById('confess-sabbat-chart'));
    createOutcomeDistChart(DATA.survival.outcomeDistribution, document.getElementById('outcome-dist-chart'));
    createTermFreqChart(DATA.survival.termComparison, document.getElementById('term-freq-chart'));
    createConfessDistribution(DATA.survival.cases, document.getElementById('confess-distribution-chart'));
    createTortureChart(DATA.survival.cases, document.getElementById('torture-chart'));
    createSabbatDistribution(DATA.survival.cases, document.getElementById('sabbat-distribution-chart'));
}
    </script>
</body>
